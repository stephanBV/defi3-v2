(this.webpackJsonpdefi3=this.webpackJsonpdefi3||[]).push([[0],{2510:function(e,t){},2814:function(e,t){},2817:function(e,t){},2839:function(e,t){},2848:function(e,t){},2866:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n(508),o=n.n(a),s=(n(521),n(1)),c=n.n(s),i=n(17),u=n(22),l=n(12),d=(n(299),n(509)),f=n.n(d),j=n(511),b=n.n(j),h=n(512),v=n.n(h),p=function(){var e=Object(u.a)(c.a.mark((function e(t,r){var a,o,s,i,u,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/contracts/".concat(t,".json"));case 2:return a=e.sent,e.next=5,a.json();case 5:return o=e.sent,(s=v()(o)).setProvider(r),e.next=10,s.deployed();case 10:return i=e.sent,(u=n(237)).setProvider(r),e.next=15,new u(o.abi,i.address);case 15:return l=e.sent,e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=n(44),m=n(9);var O=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],o=n[1];return Object(m.jsx)(m.Fragment,{children:e.workflowStatus>0?Object(m.jsx)(g.a,{variant:"secondary",disabled:!0,children:"Register Voter"}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("input",{placeholder:"Enter Address",value:a||"",onChange:function(e){o(e.target.value)}}),Object(m.jsx)(g.a,{variant:"success",onClick:function(){var t=e.instance;t.methods.addVoter(a).send({from:e.admin}).on("error",(function(){alert("Voter is already registered")})).then(t.events.VoterRegistered().once("data",(function(e){alert("Event successful! ".concat(e.event," with voterAddress:\n ").concat(e.returnValues.voterAddress))}))),o("")},children:"Register Voter"})]})})},w=n(211),x=n(76);var k=function(e){var t={0:"RegisteringVoters",1:"ProposalsRegistrationStarted",2:"ProposalsRegistrationEnded",3:"VotingSessionStarted",4:"VotingSessionEnded",5:"VotesTallied"},n=function(n){var r=e.instance,a=e.admin,o=e.setWorkflowStatus;switch(n){case 1:r.methods.startProposalsRegistering().send({from:a}).on("error",(function(){alert("That status has previously been selected!")})).then(r.events.WorkflowStatusChange().once("data",(function(e){alert("".concat(e.event," from ").concat(t[e.returnValues.previousStatus]," to ").concat(t[e.returnValues.newStatus])),o(Number(e.returnValues.newStatus))})));break;case 2:r.methods.endProposalsRegistering().send({from:a}).on("error",(function(){alert("That status has previously been selected!")})).then(r.events.WorkflowStatusChange().once("data",(function(e){alert("".concat(e.event," from ").concat(t[e.returnValues.previousStatus]," to ").concat(t[e.returnValues.newStatus])),o(Number(e.returnValues.newStatus))})));break;case 3:r.methods.startVotingSession().send({from:a}).on("error",(function(){alert("You clearly did something wrong. Try again mate!")})).then(r.events.WorkflowStatusChange().once("data",(function(e){alert("".concat(e.event," from ").concat(t[e.returnValues.previousStatus]," to ").concat(t[e.returnValues.newStatus])),o(Number(e.returnValues.newStatus))})));break;case 4:r.methods.endVotingSession().send({from:a}).on("error",(function(){alert("Transaction denied!")})).then(r.events.WorkflowStatusChange().once("data",(function(e){o(Number(e.returnValues.newStatus)),alert("".concat(e.event," from ").concat(t[e.returnValues.previousStatus]," to ").concat(t[e.returnValues.newStatus]))})));break;default:alert("wrong status")}};return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(w.a,{id:"dropdown-basic-button",title:"Update Voting Status",children:[0!==e.workflowStatus?Object(m.jsx)(x.a.Item,{onClick:function(){return n(1)},disabled:!0,children:"Start Proposals Registering"}):Object(m.jsx)(x.a.Item,{onClick:function(){return n(1)},children:"Start Proposals Registering"}),1!==e.workflowStatus?Object(m.jsx)(x.a.Item,{onClick:function(){return n(2)},disabled:!0,children:"End Proposals Registering"}):Object(m.jsx)(x.a.Item,{onClick:function(){return n(2)},children:"End Proposals Registering"}),2!==e.workflowStatus?Object(m.jsx)(x.a.Item,{onClick:function(){return n(3)},disabled:!0,children:"Start Voting Session"}):Object(m.jsx)(x.a.Item,{onClick:function(){return n(3)},children:"Start Voting Session"}),3!==e.workflowStatus?Object(m.jsx)(x.a.Item,{onClick:function(){return n(4)},disabled:!0,children:"End Voting Session"}):Object(m.jsx)(x.a.Item,{onClick:function(){return n(4)},children:"End Voting Session"})]})})};var S=function(e){var t=e.voter,n=Object(r.useState)(""),a=Object(l.a)(n,2),o=a[0],s=a[1];return Object(m.jsx)(m.Fragment,{children:1!==e.workflowStatus?Object(m.jsx)(g.a,{variant:"secondary",disabled:!0,children:"Register Proposal"}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("input",{placeholder:"Enter proposal",value:o||"",onChange:function(e){s(e.target.value)}}),Object(m.jsx)(g.a,{variant:"success",onClick:function(){var n=e.instance;n.methods.addProposal(o).send({from:t}).on("error",(function(){alert("You clearly did something wrong. Do it again!")})).then(n.events.ProposalRegistered().once("data",(function(e){alert("Your proposal has been registered!  \n proposal ID: ".concat(e.returnValues.proposalId))}))),s("")},children:"Register Proposal"})]})})};var V=function(e){var t=e.voter,n=e.instance,a=e.workflowStatus,o=Object(r.useState)(""),s=Object(l.a)(o,2),c=s[0],i=s[1];return Object(m.jsx)(m.Fragment,{children:3!==a?Object(m.jsx)(g.a,{variant:"secondary",disabled:!0,children:"Vote For Proposal"}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("input",{placeholder:"Enter Proposal ID",value:c||"",onChange:function(e){i(e.target.value)}}),Object(m.jsx)(g.a,{variant:"success",onClick:function(){n.methods.setVote(c).send({from:t}).on("error",(function(){alert("You clearly did something wrong. Come back later hay?!")})).then(n.events.Voted().once("data",(function(e){alert("Success! has ".concat(e.event," with voter:\n ").concat(e.returnValues.voter," \n and proposalId: ").concat(e.returnValues.proposalId))}))),i("")},children:"Vote For Proposal"})]})})},y=n(43),C=n(218),P=n(296);var E=function(e){var t=e.instance,n=e.voter,a=e.workflowStatus,o=Object(r.useState)(""),s=Object(l.a)(o,2),d=s[0],f=s[1],j=Object(r.useState)(""),b=Object(l.a)(j,2),h=b[0],v=b[1],p=function(e,t){return Object.entries(e).reduce((function(e,n){var r=Object(l.a)(n,2),a=r[0],o=r[1];return Object(i.a)(Object(i.a)({},e),{},Object(y.a)({},a,t(a,o)))}),{})},O=function(){var e=Object(u.a)(c.a.mark((function e(){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.methods.getVoter(d).call({from:n});case 3:r=e.sent,alert("Voter ".concat(d," \n hasVoted: ").concat(r.hasVoted," \n isRegistered: ").concat(r.isRegistered," \n voterProposalId: ").concat(r.votedProposalId)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Well that did't go the way you wanted hu?! \nYou're either not registered or the address is messed up! Go figure it out mate!");case 10:f("");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(u.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.methods.getOneProposal(h).call();case 3:n=e.sent,alert("Proposal ID ".concat(h," is ").concat(n.description)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("wrong proposal bruh..");case 10:v("");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(u.a)(c.a.mark((function e(){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.methods.getWinners().call();case 2:n=e.sent,r=p(n,(function(e,t){return t.description})),Object.keys(r).length>1?alert("==> ".concat(Object.values(r)," <==")):alert("==> ".concat(n[0][0]," <=="));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(w.a,{id:"dropdown-basic-button",title:"Getters",children:[Object(m.jsxs)(C.a,{className:"mb-3",children:[Object(m.jsx)(P.a,{placeholder:"Enter Address",value:d||"",onChange:function(e){f(e.target.value)}}),Object(m.jsx)(g.a,{variant:"outline-primary",id:"button-addon2",onClick:O,children:"getVoter"})]}),Object(m.jsxs)(C.a,{className:"mb-3",children:[Object(m.jsx)(P.a,{placeholder:"Enter Proposal Id",value:h||"",onChange:function(e){v(e.target.value)}}),Object(m.jsx)(g.a,{variant:"outline-primary",id:"button-addon2",onClick:x,children:"getOneProposal"})]}),Object(m.jsx)(C.a,{className:"mb-3",children:5!==a?Object(m.jsx)(g.a,{variant:"outline-secondary",id:"button-addon2",onClick:k,disabled:!0,children:"Election Result"}):Object(m.jsx)(g.a,{variant:"outline-primary",id:"button-addon2",onClick:k,children:"Election Result"})})]})})};var R=function(e){var t=e.instance,n=e.admin,r=e.workflowStatus,a={4:"VotingSessionEnded",5:"VotesTallied"},o=e.setWorkflowStatus,s=function(){t.methods.countVotes().send({from:n}).on("error",(function(){alert("You clearly did something wrong. try again boii!")})).then(t.events.WorkflowStatusChange().once("data",(function(e){alert("Event successful! ".concat(e.event," \n from: ").concat(a[e.returnValues.previousStatus]," \n to: ").concat(a[e.returnValues.newStatus]))}))),o(5)};return Object(m.jsx)(m.Fragment,{children:4!==r||5===r?Object(m.jsx)(g.a,{variant:"secondary",onClick:s,disabled:!0,children:"Tally Votes"}):Object(m.jsx)(g.a,{variant:"success",onClick:s,children:"Tally Votes"})})};var I=function(){var e=Object(r.useState)({provider:null,isProviderLoaded:!1,web3:null,contract:null}),t=Object(l.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(null),s=Object(l.a)(o,2),d=s[0],j=s[1],h=Object(r.useState)(null),v=Object(l.a)(h,2),g=v[0],w=v[1],x=Object(r.useState)(!1),y=Object(l.a)(x,2),C=y[0],P=(y[1],Object(r.useState)(null)),I=Object(l.a)(P,2),F=I[0],N=I[1],W=Object(r.useState)(null),T=Object(l.a)(W,2),A=T[0],L=T[1],Y=g&&n.contract,B=function(e){e.on("accountsChanged",(function(e){return window.location.reload()})),e.on("chainChanged",(function(e){return window.location.reload()}))};return Object(r.useEffect)((function(){(function(){var e=Object(u.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b()();case 2:if(t=e.sent,console.log("provider",t),!t){e.next=13;break}return B(t),e.next=8,p("Voting_cyril",t);case 8:n=e.sent,console.log("contract",n),a({web3:new f.a(t),provider:t,contract:n,isProviderLoaded:!0}),e.next=15;break;case 13:a((function(e){return Object(i.a)(Object(i.a)({},e),{},{isProviderLoaded:!0})})),console.error("Please, install Metamask.");case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(c.a.mark((function e(){var t,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.web3,e.next=3,t.eth.getAccounts();case 3:r=e.sent,a=t.utils.toChecksumAddress(r[0]),console.assert(t.utils.checkAddressChecksum(a),"checksum test failed"),w(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n.web3&&e()}),[n.web3]),Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(c.a.mark((function e(){var t,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.web3,e.next=3,t.eth.getBalance(g);case 3:r=e.sent,j(t.utils.fromWei(r,"ether"));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n.web3&&g&&e()}),[n.web3,C,g]),Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(c.a.mark((function e(){var t,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.contract,e.next=3,t.methods.workflowStatus().call();case 3:return r=e.sent,N(Number(r)),e.next=7,t.methods.owner().call();case 7:a=e.sent,L(a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n.contract&&e()}),[n.contract,C]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("div",{className:"defi3-wrapper",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"30rem"},children:Object(m.jsxs)("div",{className:"defi3",children:[n.isProviderLoaded?Object(m.jsxs)("div",{className:"is-flex is-align-items-center",children:[Object(m.jsx)("span",{children:Object(m.jsx)("strong",{className:"mr-2",children:"Account: "})}),g?Object(m.jsx)("div",{children:g}):n.provider?Object(m.jsx)("button",{className:"button is-small",onClick:function(){return n.provider.request({method:"eth_requestAccounts"})},children:"Connect Wallet"}):Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"notification is-warning is-size-6 is-rounded",children:["Wallet is not detected!"," ",Object(m.jsx)("a",{rel:"noreferrer",target:"_blank",href:"https://docs.metamask.io",children:"Install Metamask"})]})})]}):Object(m.jsx)("span",{children:"Looking for Web3..."}),!Y&&Object(m.jsx)("i",{className:"is-block",children:"Connect to network"}),Object(m.jsxs)("div",{className:"balance-view is-size-2 my-4",children:["Current Balance: ",Object(m.jsx)("strong",{children:d})," ETH"]}),Object(m.jsxs)("div",{className:"workflowStatus-view is-size-2 my-4",children:["Ongoing Workflow Status: ",F,"-",{0:"RegisteringVoters",1:"ProposalsRegistrationStarted",2:"ProposalsRegistrationEnded",3:"VotingSessionStarted",4:"VotingSessionEnded",5:"VotesTallied"}[F]]}),Object(m.jsx)(k,{instance:n.contract,admin:A,setWorkflowStatus:function(e){return N(e)},workflowStatus:F}),Object(m.jsx)("div",{style:{marginBottom:"0.8rem"}}),Object(m.jsx)(O,{instance:n.contract,admin:A,workflowStatus:F}),Object(m.jsx)(S,{instance:n.contract,voter:g,workflowStatus:F}),Object(m.jsx)(V,{instance:n.contract,voter:g,workflowStatus:F}),Object(m.jsx)(R,{instance:n.contract,admin:A,setWorkflowStatus:function(e){return N(e)},workflowStatus:F}),Object(m.jsx)(E,{instance:n.contract,voter:g,workflowStatus:F})]})})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,2874)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),o(e),s(e)}))};o.a.render(Object(m.jsx)(I,{}),document.getElementById("root")),F()},521:function(e,t,n){},534:function(e,t){},535:function(e,t){},537:function(e,t){},541:function(e,t){},567:function(e,t){},569:function(e,t){},578:function(e,t){},580:function(e,t){},589:function(e,t){},591:function(e,t){},704:function(e,t){},706:function(e,t){},713:function(e,t){},714:function(e,t){},884:function(e,t){},944:function(e,t){}},[[2866,1,2]]]);
//# sourceMappingURL=main.e87fe848.chunk.js.map